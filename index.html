<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script>
      function handleSubmit(event) {
        event.preventDefault();
        const form = document.getElementById("payroll-form");
        const data = Object.fromEntries(new FormData(form).entries());
        data.hoursWorked = parseFloat(data.hoursWorked);
        data.hourlyRate = parseFloat(data.hourlyRate);
        google.script.run
          .withSuccessHandler(() => alert("Paystub sent and recorded!"))
          .submitPayroll(data);
      }
    </script>
    <style>
      body {
        font-family: Arial;
        background-color: #f5f5f5;
        padding: 2rem;
      }
      .form-container {
        background: white;
        padding: 2rem;
        border-radius: 12px;
        max-width: 500px;
        margin: auto;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }
    </style>
  </head>
  <body>
    <div class="form-container">
      <form id="payroll-form" onsubmit="handleSubmit(event)">
        <h2>Payroll Form</h2>
        <label>Employee</label><br>
        <select name="employee" required>
          <option value="Amya Mazza">Amya Mazza</option>
          <option value="Jaya Kaur">Jaya Kaur</option>
        </select><br><br>

        <label>Pay Period</label><br>
        <input type="text" name="payPeriod" required><br><br>

        <label>Hours Worked</label><br>
        <input type="number" name="hoursWorked" required><br><br>

        <label>Hourly Rate</label><br>
        <input type="number" name="hourlyRate" required><br><br>

        <label>Deductions</label><br>
        <input type="number" name="deductions"><br><br>

        <label>Notes</label><br>
        <textarea name="notes"></textarea><br><br>

        <button type="submit">Generate Paystub</button>
      </form>
    </div>
  </body>
</html>
